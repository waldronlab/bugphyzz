---
title: "bugphyzz"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{bugphyzz}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

The `bugphyzz` package provides access to an electronic resource of 
harmonized microbial annotations from different sources. The resource can
also be accessed by direct download at **>>> insert Zenodo link here <<<**.

# Import bugphyzz

```{r, message=FALSE, eval=FALSE}
if (!require("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

## Devel version
BiocManager::install("waldronlab/bugphyzz")
```

```{r load package, message=FALSE}
library(bugphyzz)
library(dplyr)
library(purrr)
```

```{r import data}
bp <- importBugphyzz(version = 'devel', force_download = TRUE)
head(bp)
```

## Explore wich attribute groups are available

```{r}
unique(bp$Attribute_group)
```

## Explore which attribute signatures are available

```{r}
head(unique(bp$Attribute))
```

# Creating signatures

## Create signatures of taxids at the genus level for aerophilicity

```{r}
aer <- bp[which(bp$Attribute_group == 'aerophilicity'),]
sigs1 <- getBugphyzzSignatures(
  df = aer, tax.id.type = 'NCBI_ID', tax.level = 'genus', min.size = 10
)
map(sigs1, head)
```

## Create signatures of taxa names at the species level for optimal ph 
```{r}
op <- bp[bp$Attribute_group == 'optimal ph', ]
sigs2 <- getBugphyzzSignatures(
  df = op, tax.id.type = 'Taxon_name', tax.level = 'species', min.size = 10
)
map(sigs2, head)
```


# Other examples

```{r}
mot <- bp[bp$Attribute_group == 'motility',]
sigs3 <- getBugphyzzSignatures(
  df = mot, tax.id.type = 'Taxon_name', tax.level = 'mixed'
)
lapply(sigs3, head)
```

# Merge examples above

```{r}
sigs <- c(sigs1, sigs2, sigs3)
lapply(sigs, head)
```


## Session information:

```{r}
sessioninfo::session_info()
```
