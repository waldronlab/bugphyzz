---
title: "bugphyzz"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{bugphyzz}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

The `bugphyzz` package provides access to an electronic resource of 
harmonized microbial annotations from different sources. The resource can
also be accessed by direct download at **>>> insert Zenodo link here <<<**.

# Import bugphyzz

```{r, eval=FALSE}
if (!require("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

## Devel version
BiocManager::install("waldronlab/bugphyzz")
```

```{r load package, message=FALSE}
library(bugphyzz)
library(dplyr)
library(purrr)
```

```{r import data}
bp <- importBugphyzz(version = 'devel')
head(map(bp, head))
```

## Explore wich attribute groups are available

```{r}
names(bp)
```

# Create signatures

## Create signatures of taxids at the genus level for aerophilicity

```{r}
aer_sigs_g <- makeSignatures(
  dat = bp[["aerophilicity"]], tax_id_type = "NCBI_ID", tax_level = "genus"
)
map(aer_sigs_g, head)
```

## Create signatures of taxa names at the species level for growth temperature

```{r}
gt_sigs_sp <- makeSignatures(
  dat = bp[["growth temperature"]], tax_id_type = "Taxon_name",
  tax_level = 'species'
)
map(gt_sigs_sp, head)
```

## Create signatures with custom threshold for numeric attributes

```{r}
gt_sigs_mix <- makeSignatures(
  dat = bp[["growth temperature"]], tax_id_type = "Taxon_name",
  tax_level = "mixed", min = 0, max = 25
)
map(gt_sigs_mix, head)
```

## Create signatures for a binary attribute

```{r}
ap_sigs_mix <- makeSignatures(
  dat = bp[["animal pathogen"]], tax_id_type = "NCBI_ID",
  tax_level = "mixed", evidence = c("exp", "igc", "nas", "tas")
)
map(ap_sigs_mix, head)
```

## Make signatures for all datasets with a single function call

```{r}
sigs <- map(bp, makeSignatures) |> 
  list_flatten()
length(sigs)
```


```{r}
head(map(sigs, head))
```

## Session information:

```{r}
sessioninfo::session_info()
```
